<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <title>Cleric Mobile v19 (Fixed)</title>
  <style>
    body { margin:0; padding:0; background:#050505; color:white; font-family:'Segoe UI',sans-serif; overflow:hidden; touch-action:none; user-select:none; -webkit-user-select:none; }
    #game-container { position:relative; width:100vw; height:100vh; background:#111; overflow:hidden; }
    canvas { display:block; width:100%; height:100%; }

    #rotate-message { display:none; position:absolute; top:0; left:0; width:100%; height:100%; background:#000; z-index:999; flex-direction:column; justify-content:center; align-items:center; text-align:center; }
    @media screen and (orientation:portrait){ #rotate-message{ display:flex; font-size:0.8em; } }

    .top-bar { position:absolute; top:0; left:0; width:100%; height:42px; background:linear-gradient(180deg,rgba(0,0,0,0.85),rgba(0,0,0,0)); display:flex; justify-content:space-between; align-items:center; padding:0 10px; box-sizing:border-box; z-index:10; }
    .res-cluster { display:flex; flex-direction:column; width:36%; }
    .bar-bg { width:100%; height:6px; background:#333; margin-bottom:3px; border-radius:3px; overflow:hidden; border:1px solid #444; }
    .bar-fill { height:100%; transition:width 0.1s; }
    #hp-bar .bar-fill{background:#ff4444;} #ap-bar .bar-fill{background:#ffd700;} #stam-bar .bar-fill{background:#4caf50;} #div-bar .bar-fill{background:#00bfff;}
    .res-label { font-size:9px; font-weight:bold; text-shadow:1px 1px 1px black; margin-bottom:2px; }
    .score-box { text-align:center; font-size:14px; color:gold; font-weight:bold; text-shadow:0 2px 4px black; }

    .joystick-zone { position:absolute; width:100px; height:100px; pointer-events:auto; z-index:20; }
    #stick-left-zone { left:12px; bottom:32px; }
    #stick-right-zone { right:20px; bottom:180px; pointer-events:auto; } /* raised higher */

    .joystick-base { width:70px; height:70px; background:rgba(255,255,255,0.05); border:1px solid rgba(255,255,255,0.1); border-radius:50%; position:absolute; top:50%; left:50%; transform:translate(-50%,-50%); display:flex; justify-content:center; align-items:center; }
    .joystick-stick { width:30px; height:30px; background:rgba(255,255,255,0.3); border-radius:50%; position:absolute; box-shadow:0 0 10px rgba(0,0,0,0.5); }

    #skill-cluster { position:absolute; bottom:10px; right:10px; width:200px; height:200px; pointer-events:none; }
    .btn { pointer-events:auto; position:absolute; border-radius:50%; background:#222; border:2px solid #555; display:flex; justify-content:center; align-items:center; color:white; font-weight:bold; font-size:10px; box-shadow:0 4px 6px rgba(0,0,0,0.4); }
    .btn:active { transform:scale(0.9)!important; border-color:white; background:#444; }
    .btn-main{width:46px;height:46px;} .btn-sub{width:40px;height:40px;} .btn-mini{width:30px;height:30px;}

    #btn-dodge{width:52px;height:52px;bottom:18px;right:18px;background:#333;border-color:#999;z-index:25;font-size:9px;}
    #btn-lmb{bottom:70px;right:14px;background:#1a3a1a;color:#39FFAC;}
    #btn-rmb{bottom:14px;right:84px;background:#3a3a1a;color:#ffd700;}
    #btn-q{bottom:110px;right:10px;background:#2d1515;color:#ff8888;}
    #btn-e{bottom:92px;right:60px;background:#2d1515;color:#ff8888;}
    #btn-r{bottom:52px;right:110px;background:#2d1515;color:#ff8888;}
    #btn-tab{bottom:130px;right:96px;background:#001a33;color:#00bfff;}
    #btn-daily{width:40px;height:40px;bottom:74px;right:145px;background:#333300;border:2px solid gold;color:gold;z-index:50;}

    #menu-overlay { position:absolute; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.9); display:flex; flex-direction:column; justify-content:center; align-items:center; z-index:100; }
    .menu-btn { padding:12px 30px; background:#3498db; color:white; border:none; font-size:18px; border-radius:8px; margin:10px; font-weight:bold; }
  </style>
</head>
<body>
<div id="rotate-message"><h2 style="color:#ffd700;">Please Rotate Device</h2><p>This game requires Landscape mode.</p></div>
<div id="game-container">
  <canvas id="gameCanvas"></canvas>
  <div class="top-bar">
    <div class="res-cluster">
      <div class="res-label" style="color:#ff4444;">HP <span id="hp-val"></span></div>
      <div class="bar-bg" id="hp-bar"><div class="bar-fill"></div></div>
      <div class="res-label" style="color:#4caf50;">STAM</div>
      <div class="bar-bg" id="stam-bar"><div class="bar-fill"></div></div>
    </div>
    <div class="score-box"><div id="game-timer">0.0</div><div id="game-score" style="font-size:10px;color:#aaa;">0</div></div>
    <div class="res-cluster" style="align-items:flex-end;">
      <div class="res-label" style="color:#00bfff;">DIVINITY</div>
      <div class="bar-bg" id="div-bar"><div class="bar-fill"></div></div>
      <div class="res-label" style="color:#ffd700;">AP</div>
      <div class="bar-bg" id="ap-bar"><div class="bar-fill"></div></div>
    </div>
  </div>
  <div class="ui-layer">
    <div id="stick-left-zone" class="joystick-zone"><div class="joystick-base"><div class="joystick-stick" id="stick-left"></div></div></div>
    <div id="stick-right-zone" class="joystick-zone"><div class="joystick-base"><div class="joystick-stick" id="stick-right"></div></div></div>
    <div id="skill-cluster">
      <div id="btn-dodge" class="btn">DASH</div>
      <div id="btn-lmb" class="btn btn-main">üî•</div>
      <div id="btn-rmb" class="btn btn-main">üî¶</div>
      <div id="btn-q" class="btn btn-sub">‚ö°</div>
      <div id="btn-e" class="btn btn-sub">üí•</div>
      <div id="btn-r" class="btn btn-sub">‚ûï</div>
      <div id="btn-tab" class="btn btn-mini">‚öñÔ∏è</div>
      <div id="btn-daily" class="btn btn-sub">ULT</div>
    </div>
  </div>
  <div id="menu-overlay">
    <h1 id="menu-title" style="color:#ffd700;">CLERIC MOBILE</h1>
    <p id="menu-msg" style="color:#ddd;">Survive for 2 Minutes.</p>
    <button class="menu-btn" onclick="startGame()">START</button>
  </div>
</div>
<script>
const
